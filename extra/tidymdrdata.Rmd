---
title: "Project tidying"
author: "MDR Intertidal"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
library(readxl)
```

```{r load-data-2017}

horizontal_MDR_NeCSA_2017  <- read_excel("/cloud/project/data/2017_horizontal_MDR_NeCSA.xlsx", na = c("*all rock", "*skipped because of tide pool"))

seaweed_mdr_2017 <- horizontal_MDR_NeCSA_2017 %>%
  subset(select = -c(Site, Name, Llitt:SembalA2 )) %>%
  add_column(year = "2017") %>%
  rename(Asco_nCC = AscoCC, Fucu_vCC = FucVCC, Fucu_sCC = FucSCC, Fucu_dCC = FucDCC, Fuc_spp = FucSpp.CC, Asco_nSC = AscoSC, Fucu_vSC = FucVSC, Fucu_sSC = FucSSC, Fucu_dSC = FucDSC, Mast_sSC = MstellSC, Chon_cSC = ChonCrSC, Ulva_iSC = UlvaIntesSC, Ulva_lSC = UlvaLacSC, Coro_oSC = CorOSC, Vert_lSC = VertLanSC, Cera_rSC = CerSC, Lam_spp = `Laminaria spp.`, Por_sp = `Porphyra sp.`, Asco_recuit = AscoR, Asco_holdfasts = AscoA, Fucu_Recruits = FucR, Fucu_vHoldfasts = FucVA, Fucu_sHoldfasts = FucSA, Fucu_dHoldfasts = FucDA, Asco_nHt = `AscoHeight (cm)`, Asco_nBladders = AscoBladders, Fucu_sppHoldfasts = FucSppA) %>%
  pivot_longer(
    cols = Asco_nCC:Fucu_sppHoldfasts,
    names_to = "seaweed_species",
    values_to = "squares out of 25") %>%
  mutate(proportion = `squares out of 25`/25)
  
 inverts_mdr_2017 <- horizontal_MDR_NeCSA_2017 %>%
   subset(select = -c(Site, Name, AscoCC:AscoBladders, CarmaeMale, CarmaeFem, CarmaeEgg, HemiMale, HemiFem, HemiEgg, CanirrMale:CanirrEgg, CanborMale:SembalA2)) %>%
   add_column(year = "2017") %>%
   rename(Litt_l = Llitt, Litt_o = Liobtu, Litt_s = Lsax, Litt_spp = `Litt. Spp.`, Nuci_l = Nlap, Lacu_v = Lacvinc, Hiat_a = Hiatarct, Ostr_e = Ostredu, Myti_e = Myted, Modi_m = Modmod, Tect_t = Testtest, Crep_f = Crepfor, Urti_f = Urtfel, Metr_s = Metrsen, Aste_f = Astfor, Aste_v = Astvul, Stro_d = Strongdro, Lepi_s = Lepsqua, Dide_v = Didvex, Botr_s = Botrysch, Cion_i = Ciointes, Gama_spp = Gamarus, Carc_m = CarmaeTot, Hemi_s = HemiTot, Canc_i = CanirrTot, Canc_b = CanborTot) %>%
   pivot_longer(
     cols = Litt_l:Canc_b,
     names_to = "invert_species",
     values_to = "count"
   )

```

```{r load-data-2018}

# not sure if this spreadsheet is complete - omit?

# low quadrats

HL00_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "A4:C49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 0)

HL03_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "D4:F49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 3)

HL06_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "G4:I49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 6)

HL09_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "J4:L49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 9)

HL12_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "M4:O49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 12)

HL15_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "P4:R49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 15)

HL18_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "S4:U49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 18)

HL21_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "V4:X49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 21)

HL24_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "Y4:AA49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 24)

HL27_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Low", range = "AB4:AD49") %>%
  mutate(tide_height = "low",
         year = "2018",
         quadrat = 27)

# mid quadrats

HM00_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "A4:C49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 0)

HM03_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "D4:F49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 3)

HM06_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "G4:I49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 6)

HM09_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "J4:L49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 9)

HM12_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "M4:O49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 12)

HM15_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "P4:R49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 15)

HM18_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "S4:U49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 18)

HM21_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "V4:X49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 21)

HM24_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "Y4:AA49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 24)

HM27_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT Mid", range = "AB4:AD49") %>%
  mutate(tide_height = "mid",
         year = "2018",
         quadrat = 27)

# high quadrats

HH00_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "A4:C49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 0)

HH03_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "D4:F49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 3)

HH06_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "G4:I49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 6)

HH09_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "J4:L49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 9)

HH12_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "M4:O49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 12)

HH15_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "P4:R49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 15)

HH18_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "S4:U49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 18)

HH21_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "V4:X49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 21)

HH24_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "Y4:AA49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 24)

HH27_MDR_NeCSA_2018 <- read_excel("/cloud/project/data/2018_full_NeCSA.xlsx", sheet = "West HT High", range = "AB4:AD49") %>%
  mutate(tide_height = "high",
         year = "2018",
         quadrat = 27)

```

```{r load-data-2019}

horizontal_MDR_NeCSA_2019  <- read_excel("/cloud/project/data/2019_horizontal_MDR_NeCSA.xlsx")

```

```{r load-data-2020}

horizontal_MDR_NeCSA_2020  <- read_excel("/cloud/project/data/2020_horizontal_MDR_NeCSA.xlsx")

seaweed_mdr_2020 <- horizontal_MDR_NeCSA_2020 %>%
  subset(select = -c(Site, Name, Notes, Semi_bCC, Myti_eCC, Semi_bSC, Myti_eSC, Urti_f:Notes ))  %>%
  add_column(year = "2020") %>%
  pivot_longer(
    cols = Asco_nCC:Cera_rSC,
    names_to = "seaweed_species",
    values_to = "squares out of 25") %>%
  mutate(proportion = `squares out of 25`/25)

inverts_mdr_2020 <- horizontal_MDR_NeCSA_2020 %>%
   subset(select = -c(Site, Name, Notes, Asco_nCC:Fucu_dCC, Asco_nSC:Cera_rSC, Asco_nHt, Asco_nBladders, Myti_eMethod)) %>%
   add_column(year = "2020") %>%
   pivot_longer(
     cols = Semi_bCC:Semi_bA2,
     names_to = "invert_species",
     values_to = "count"
   )

```

```{r load-data-2021}

horizontal_MDR_NeCSA_2021  <- read_excel("/cloud/project/data/2021_horizontal_MDR_NeCSA.xlsx")

seaweed_mdr_2021 <- horizontal_MDR_NeCSA_2021 %>%
  subset(select = -c(Site, Name, Notes, Semi_bCC, Myti_eCC, Semi_bSC, Myti_eSC, Urti_f:Notes ))  %>%
  add_column(year = "2021") %>%
  pivot_longer(
    cols = Asco_nCC:Cera_rSC,
    names_to = "seaweed_species",
    values_to = "squares out of 25") %>%
  mutate(proportion = `squares out of 25`/25)

inverts_mdr_2021 <- horizontal_MDR_NeCSA_2021 %>%
   subset(select = -c(Site, Name, Notes, Asco_nCC:Fucu_dCC, Asco_nSC:Cera_rSC, Asco_nHt, Asco_nBladders, Myti_eMethod)) %>%
   add_column(year = "2021") %>%
   pivot_longer(
     cols = Semi_bCC:Semi_bA2,
     names_to = "invert_species",
     values_to = "count"
   )

```

```{r load-data-2022}

horizontal_MDR_NeCSA_2022  <- read_excel("/cloud/project/data/2022_horizontal_MDR_NeCSA.xlsx")

seaweeds_mdr_2022 <- horizontal_MDR_NeCSA_2022 %>%
  subset(select = -c(Site, Name, Semi_bCC, Myti_eCC, Semi_bSC, Myti_eSC, Urti_f:Notes)) %>%
  add_column(year = "2022") %>%
  pivot_longer(
    cols = Asco_nCC:Cera_rSC,
    names_to = "seaweed_species",
    values_to = "proportion")
  
inverts_mdr_2022 <- horizontal_MDR_NeCSA_2022 %>%
  subset(select = -c(Site, Name, Asco_nCC:Fucu_dCC, Asco_nSC:Cera_rSC, Asco_nHt, Asco_nBladders, Myti_eMethod, Notes)) %>%
  add_column(year = "2022") %>%
  pivot_longer(
    cols = Semi_bCC:Semi_bA2,
    names_to = "invert_species",
    values_to = "count")
```

```{r load-data-2023}

horizontal_MDR_NeCSA_2023  <- read_excel("/cloud/project/data/2023_horizontal_MDR_NeCSA.xlsx")

seaweeds_mdr_2023 <- horizontal_MDR_NeCSA_2023 %>%
  subset(select = -c(Site, Name, Semi_bCC, Myti_eCC, Semi_bSC, Myti_eSC, Urti_f:Notes)) %>%
  add_column(year = "2023") %>%
  pivot_longer(
    cols = Asco_nCC:Cera_rSC,
    names_to = "seaweed_species",
    values_to = "proportion")
  
inverts_mdr_2023 <- horizontal_MDR_NeCSA_2023 %>%
  subset(select = -c(Site, Name, Asco_nCC:Fucu_dCC, Asco_nSC:Cera_rSC, Asco_nHt, Asco_nBladders, Myti_eMethod, Notes)) %>%
  add_column(year = "2023") %>%
  pivot_longer(
    cols = Semi_bCC:Semi_bA2,
    names_to = "invert_species",
    values_to = "count")
  
```

